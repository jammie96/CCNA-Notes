Scenario:
- You have just been tasked with optimizing network efficiency within your company network
- There is a suspicion that traffic from some PCs is perhaps taking a suboptimal route
- The traffic appears to route through a branch office before reaching the internet, which is causing unnecessary delays and bandwidth issues
- Your mission is to investigate these network paths and identify any issues

- Traffic might be inadvertently routed through the branch office due to misconfigurations in routing protocols or incorrect static route entries
- Changes in the network topology or the integration of new devices and services could have altered optimal routing paths without corresponding updates to routing configurations
- Limited visibility into all network segments might obscure the full path that packets take, complicating efforts to diagnose and correct the suboptimal routing

![[Pasted image 20241104204359.png]]
> According to the network documentation, the PC should take the optimal path to reach the internet
> 	- How can you verify this and confirm any routing issues relating to packet delivery?

### Layer 2 Addressing
- Layer 2 Ethernet LANs have the following characteristics:
	- They use MAC addresses
	- They identify end devices in the LAN
	- They enable the packet to be carried by the local media across each segment

![[Pasted image 20241104205829.png]]

- Layer 2 defines how data is formatted for transmission and how access to the physical media is controlled
- Layer 2 devices provide an interface with the physical media
	- E.g. Network Interface Cards (NICs) installed in a host
- Device-to-device communications require Layer 2 addresses, also known as physical addresses
	- E.g. Ethernet physical addresses or MAC addresses are embedded in Ethernet NIC in end devices, such as hosts
- Although MAC addresses are unique, physical addresses are not hierarchical
	- They are associated with a particular device, regardless of its location or connected network
	- These Layer 2 addresses have no meaning outside the local network media
	- They are used to locate the end devices in the local physical network on the data link layer
	- An Ethernet MAC address is a two-part, 48-bit binary value that is expressed as 12 hexadecimal digits
		- The address formats might appear like 00-05-9A-3C-78-00 or 00:05:9A:3C:78:00
- All devices that are connected to an Ethernet LAN have MAC-addressed interfaces
	- The NIC uses the MAC address in received frames to determine if a message should be passed to the upper layers for processing
	- The MAC address is permanently encoded to a ROM chip on a NIC
	- The MAC address is made up of the Organizationally Unique Identifier (OUI) and the vendor assignment number
- Switches also have MAC addresses but a device on sends a frame to these addresses when communicating with the switch, e.g. for management
	- Otherwise frames are addressed for other devices and the switch forwards the frames to those devices

![[Pasted image 20241104210633.png]]
>The figure shows the L2 addresses on 2 PCs and a router
>Note that the router has different MAC addresses on each interface

### Layer 3 Addressing
![[Pasted image 20241105204342.png]]
- Layer 3 provides connectivity and path selection between 2 host systems located on geographically separated routes
	- At the boundary of each local network, an intermediary network device, usually a router, de-encapsulated the frame to read the destination address contained in the packet's header (Layer 3 Protocol Data Unit (PDU))
- Routers use the network identifies portion of this address to determine which path to use to reach the destination host
	- Once the path is determined, the router encapsulates the packet in a new frame and sends it toward the destination end device
- Layer 3 addresses must include identifiers that enable intermediary network devices to locate the network that different hosts belong to
	- In the TCP/IP protocol suite, every IP host address contains information about the network where the host is located
- Intermediary devices that connect networks are routers #Routers 
	- The role of the router is to select paths and direct packets toward a destination
		- This process is known as routing
	- A router uses a list of paths located in a routing table to determine where to send data
- Layer 3 addresses are assigned to end devices such as hosts and network devices that provide Layer 3 functions
	- The router has its own Layer 3 address on each interface
	- Each network device that provides a Layer 3 function maintains a routing table

![[Pasted image 20241105204456.png]]
> The 2 router interfaces belong to different networks
> 	- The left interface and the directly connected PC belong to the 192.168.3.0/24 network
> 	- The right interface and the directly connected PC belong to the 192.168.4.0/24 network
> For devices in different IP networks, a Layer 3 device is needed to router traffic between them
### Default Gateways
![[Pasted image 20241105205329.png]]
- A source host can communicate directly (without a router) with a destination host only if the 2 hosts are on the same subnet
	- If they are on different subnet, the sending host must send the data to its default gateway, which will forward the data to the destination
- The default gateway is an address on a router (or Layer 3 switch) connected to the same subnet that the source host is on
- Before a host can send a packet to its destination, it must first determine if the destination address is on its local subnet or not
	- It uses the subnet mask in this determination
	- The subnet mask describes which portion of an IPv4 address refers to the network or subnet and which part refers to the host
- The source host first does an AND operation between its own IPv4 address and subnet mask to arrive at its local subnet address
	- To determine if the destination address is on the same subnet, the source host then does an AND operation between the destination IPv4 address and the source's subnet mask
		- This is because it does not know the subnet mask of the destination address
		- And if the devices are on the same subnet, they must have the same mask
	- If the resulting subnet address is the same, it knows the source and destination are on the same subnet
		- Otherwise, they are on different subnets
- E.g. IPv4 host 10.10.1.241/24 is on the 10.10.1.0/24 subnet
	- If the host that it wants to communicate with is 10.10.1.175, it knows that this IPv4 host is also on the local 10.10.1.0/24 subnet
- If the source and destination devices are on the same subnet, then the source can deliver the packet directly
	- If they are on different subnets, then the packets must be forwarded to the default gateway, which will forward to its destination
- The default gateway address must have the same network and subnet portion as the local host address
	- In other words, the default gateway must be on the same subnet as the local host

![[Pasted image 20241105211244.png]]
- Host is configured with the address of their default gateway
	- On a Windows computer, the Internet Protocol (TCP/IP) Properties tools are used to enter the default gateway IP address if you need to set the network parameters manually
	- These parameters may also be learned automatically

### Address Resolution Protocol (ARP) #ARP 



### Host-To-Host Packet Delivery



